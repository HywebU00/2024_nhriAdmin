import{s as oe,x as Me,y as m,z as f,A as fe,B as Ie,C as _t,D as St,o as R,c as X,E as Nt,G as ue,r as ke,b as K,H as x,h as ye,v as Fe,i as Ee,f as ie,j as ve,I as Be,J as xt,F as ft,d as gt,t as me,K as ht,g as kt,L as wt,M as de,e as yt,N as Kt,O as Dt,w as At,P as $t,Q as Ft}from"./index-0661af85.js";var Et=Object.defineProperty,Bt=(e,t,a)=>t in e?Et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,B=(e,t,a)=>(Bt(e,typeof t!="symbol"?t+"":t,a),a);const Vt=["_level","_filterVisible","_parent","_loading","_loaded","_remote","_keyField","children","setChildren"];class ee{constructor(t,a=null,n="id",l=!1){B(this,"_level",0),B(this,"checked",!1),B(this,"selected",!1),B(this,"indeterminate",!1),B(this,"disabled",!1),B(this,"expand",!1),B(this,"visible",!0),B(this,"_filterVisible",!0),B(this,"_parent",null),B(this,"children",[]),B(this,"isLeaf",!1),B(this,"_loading",!1),B(this,"_loaded",!1),this._keyField=n,this._remote=l;for(let s in t)Vt.indexOf(s)===-1&&(this[s]=t[s]);this[n]==null&&(this[n]=Math.random().toString(36).substring(2)),this._parent=a,this._parent&&(this._level=this._parent._level+1),this.visible=this._parent===null||this._parent.expand&&this._parent.visible,Array.isArray(t.children)&&this.setChildren(t.children),this.children.length&&(this._loaded=!0),this._remote||(this.isLeaf=!this.children.length)}setChildren(t){this.children=t.map(a=>new ee(Object.assign({},a),this,this._keyField,this._remote))}}var Ce=(e=>(e.none="none",e.parents="parents",e.children="children",e))(Ce||{});const Mt=["setData","setChecked","setCheckedKeys","checkAll","clearChecked","setSelected","clearSelected","setExpand","setExpandKeys","setExpandAll","getCheckedNodes","getCheckedKeys","getIndeterminateNodes","getSelectedNode","getSelectedKey","getExpandNodes","getExpandKeys","getCurrentVisibleNodes","getNode","getTreeData","getFlatData","getNodesCount","insertBefore","insertAfter","append","prepend","remove","filter","showCheckedNodes","loadRootNodes","scrollTo"];var vt=(e=>(e["bottom-start"]="bottom-start",e["bottom-end"]="bottom-end",e.bottom="bottom",e["top-start"]="top-start",e["top-end"]="top-end",e.top="top",e))(vt||{}),ge=(e=>(e.top="top",e.center="center",e.bottom="bottom",e))(ge||{}),J=(e=>(e.before="before",e.body="body",e.after="after",e))(J||{});const Ve=["expand","check","click","select","node-dblclick","node-right-click","node-dragstart","node-dragenter","node-dragover","node-dragleave","node-drop"];class It{constructor(t){B(this,"data",[]),B(this,"flatData",[]),B(this,"mapData",Object.create(null)),B(this,"unloadCheckedKeys",[]),B(this,"unloadSelectedKey",null),B(this,"currentSelectedKey",null),B(this,"listenersMap",{}),this.options=t}setData(t,a=null,n=null){this.data=t.map(l=>new ee(l,null,this.options.keyField,!!this.options.load));for(let l in this.mapData)delete this.mapData[l];this.currentSelectedKey=null,this.flatData=this.flattenData(this.data),this.setUnloadCheckedKeys(n||[]),a&&(this.currentSelectedKey=null,this.setUnloadSelectedKey(a)),this.emit("visible-data-change"),this.emit("set-data")}setChecked(t,a,n=!0,l=!0,s=!1){const o=this.mapData[t];if(!o)return this.setUnloadChecked(t,a,n,l);o.disabled||o.checked&&a||!o.checked&&!o.indeterminate&&!a||(this.options.cascade?(this.checkNodeDownward(o,a,s),this.checkNodeUpward(o)):o.checked=a,n&&(o.checked?this.emit("check",o):this.emit("uncheck",o)),this.triggerCheckedChange(n,l))}setUnloadChecked(t,a,n=!0,l=!0){const s=this.findIndex(t,this.unloadCheckedKeys);a?s===-1&&this.unloadCheckedKeys.push(t):s!==-1&&this.unloadCheckedKeys.splice(s,1),this.triggerCheckedChange(n,l)}setCheckedKeys(t,a,n=!0,l=!0){t.forEach(s=>{this.setChecked(s,a,!1,!1)}),this.triggerCheckedChange(n,l)}checkAll(t=!0,a=!0){if(this.options.cascade){const n=l=>{l.forEach(s=>{s.disabled?n(s.children):this.setChecked(s[this.options.keyField],!0,!1,!1)})};n(this.data)}else{const n=this.flatData.length;for(let l=0;l<n;l++){const s=this.flatData[l];this.setChecked(s[this.options.keyField],!0,!1,!1)}}this.triggerCheckedChange(t,a)}clearChecked(t=!0,a=!0){this.getCheckedNodes().forEach(n=>{this.setChecked(n[this.options.keyField],!1,!1,!1)}),this.unloadCheckedKeys=[],this.triggerCheckedChange(t,a)}triggerCheckedChange(t=!0,a=!0){t&&this.emit("checked-change",this.getCheckedNodes(),this.getCheckedKeys()),a&&this.emit("render-data-change")}setSelected(t,a,n=!0,l=!0){const s=this.mapData[t];if(!s)return this.setUnloadSelected(t,a,n,l);s.disabled||s.selected!==a&&(t===this.currentSelectedKey?a||(s.selected=a,this.currentSelectedKey=null):a&&(this.currentSelectedKey===null?(s.selected=a,this.currentSelectedKey=s[this.options.keyField]):(this.mapData[this.currentSelectedKey]&&(this.mapData[this.currentSelectedKey].selected=!1),s.selected=a,this.currentSelectedKey=s[this.options.keyField])),n&&(s.selected?this.emit("select",s):this.emit("unselect",s),this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey())),l&&this.emit("render-data-change"))}setUnloadSelected(t,a,n=!0,l=!0){a?(this.currentSelectedKey&&this.setSelected(this.currentSelectedKey,!1,!1,!1),this.unloadSelectedKey=t):this.unloadSelectedKey===t&&(this.unloadSelectedKey=null),n&&this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey()),l&&this.emit("render-data-change")}clearSelected(t=!0,a=!0){this.currentSelectedKey&&this.mapData[this.currentSelectedKey]?this.setSelected(this.currentSelectedKey,!1,t,a):this.unloadSelectedKey!==null&&(this.unloadSelectedKey=null,t&&this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey()),a&&this.emit("render-data-change"))}setExpand(t,a,n=!1,l=!0,s=!0){const o=this.mapData[t];if(!(!o||!n&&o.isLeaf)&&o.expand!==a){if(!o.isLeaf){if(typeof this.options.load=="function"){if(!o._loaded&&!o._loading&&a){o._loading=!0,s&&this.emit("visible-data-change"),new Promise((u,k)=>{const D=this.options.load;D(o,u,k)}).then(u=>{if(Array.isArray(u)){const k=this.findIndex(o);if(k===-1)return;o._loaded=!0,o.expand=a,o.setChildren(u);const D=this.getCheckedKeys(),C=this.flattenData(o.children,this.getSelectedKey===null);this.flatData.splice(k+1,0,...C),this.setUnloadCheckedKeys(D),this.unloadSelectedKey!==null&&this.setUnloadSelectedKey(this.unloadSelectedKey),this.emit("set-data")}}).catch(u=>{}).then(()=>{o._loading=!1,l&&this.emit("expand",o),s&&this.emit("visible-data-change")});return}else if(o._loading)return}o.expand=a;const i=[...o.children];for(;i.length;)i[0].expand&&i[0].children.length&&i.push(...i[0].children),i[0]._filterVisible===!1?i[0].visible=!1:i[0].visible=i[0]._parent===null||i[0]._parent.expand&&i[0]._parent.visible,i.shift();l&&this.emit("expand",o),s&&this.emit("visible-data-change")}n&&o._parent&&a&&this.setExpand(o._parent[this.options.keyField],a,n,!1,s)}}setExpandKeys(t,a,n=!0){t.forEach(l=>{this.setExpand(l,a,!1,!1,!1)}),n&&this.emit("visible-data-change")}setExpandAll(t,a=!0){this.flatData.forEach(n=>{(!this.options.load||n._loaded)&&this.setExpand(n[this.options.keyField],t,!1,!1,!1)}),a&&this.emit("visible-data-change")}getCheckedNodes(t=this.options.ignoreMode){if(t===Ce.children){const a=[],n=l=>{l.forEach(s=>{s.checked?a.push(s):!s.isLeaf&&s.indeterminate&&n(s.children)})};return n(this.data),a}else return this.flatData.filter(a=>t===Ce.parents?a.checked&&a.isLeaf:a.checked)}getCheckedKeys(t=this.options.ignoreMode){return this.getCheckedNodes(t).map(a=>a[this.options.keyField]).concat(this.unloadCheckedKeys)}getIndeterminateNodes(){return this.flatData.filter(t=>t.indeterminate)}getSelectedNode(){return this.currentSelectedKey===null?null:this.mapData[this.currentSelectedKey]||null}getSelectedKey(){return this.currentSelectedKey||this.unloadSelectedKey||null}getUnloadCheckedKeys(){return this.unloadCheckedKeys}getExpandNodes(){return this.flatData.filter(t=>!t.isLeaf&&t.expand)}getExpandKeys(){return this.getExpandNodes().map(t=>t[this.options.keyField])}getNode(t){return this.mapData[t]||null}insertBefore(t,a){const n=this.getInsertedNode(t,a);if(!n)return null;this.remove(n[this.options.keyField],!1);const l=this.mapData[a]._parent,s=this.findIndex(a,l&&l.children),o=this.findIndex(a),i=l&&-1||this.findIndex(a,this.data);return this.insertIntoStore(n,l,s,o,i),this.emit("visible-data-change"),n}insertAfter(t,a){const n=this.getInsertedNode(t,a);if(!n)return null;this.remove(n[this.options.keyField],!1);const l=this.mapData[a],s=l._parent,o=this.findIndex(a,s&&s.children)+1,i=this.flatData.length,u=this.findIndex(a);let k=u+1;for(let C=u+1;C<=i;C++){if(C===i){k=C;break}if(this.flatData[C]._level<=l._level){k=C;break}}const D=s&&-1||this.findIndex(a,this.data)+1;return this.insertIntoStore(n,s,o,k,D),this.emit("visible-data-change"),n}append(t,a){const n=this.mapData[a];if(!n.isLeaf){const o=n.children.length;return this.insertAfter(t,n.children[o-1][this.options.keyField])}const l=this.getInsertedNode(t,a,!0);if(!l)return null;this.remove(l[this.options.keyField],!1);const s=this.findIndex(a)+1;return this.insertIntoStore(l,n,0,s),this.emit("visible-data-change"),l}prepend(t,a){const n=this.mapData[a];if(!n.isLeaf)return this.insertBefore(t,n.children[0][this.options.keyField]);const l=this.getInsertedNode(t,a,!0);if(!l)return null;this.remove(l[this.options.keyField],!1);const s=this.findIndex(a)+1;return this.insertIntoStore(l,n,0,s),this.emit("visible-data-change"),l}remove(t,a=!0){const n=this.mapData[t];if(!n)return null;const l=this.findIndex(n);if(l===-1)return null;let s=1;const o=this.flatData.length;for(let u=l+1;u<o&&this.flatData[u]._level>n._level;u++)s++;this.flatData.splice(l,s);const i=u=>{const k=this.mapData[u];delete this.mapData[u],k.children.forEach(D=>i(D[this.options.keyField]))};if(i(t),!n._parent){const u=this.findIndex(n,this.data);u>-1&&this.data.splice(u,1)}if(n._parent){const u=this.findIndex(n,n._parent.children);u!==-1&&n._parent.children.splice(u,1),n._parent.isLeaf=!n._parent.children.length,n._parent.isLeaf&&(n._parent.expand=!1,n._parent.indeterminate=!1),this.updateMovingNodeStatus(n)}return a&&this.emit("visible-data-change"),n}getInsertedNode(t,a,n=!1){const l=this.mapData[a];if(!l)return null;const s=n?l:l._parent;return t instanceof ee?t[this.options.keyField]===a?null:t:typeof t=="object"?t[this.options.keyField]===a?null:this.mapData[t[this.options.keyField]]||new ee(t,s,this.options.keyField,!!this.options.load):!this.mapData[t]||t===a?null:this.mapData[t]}insertIntoStore(t,a,n,l,s){if(l===-1)return;n!==-1&&a&&a.children.splice(n,0,t),t._parent=a,a?(a.isLeaf=!1,this.setExpand(a[this.options.keyField],!0,!1,!1,!1)):typeof s=="number"&&s>-1&&this.data.splice(s,0,t);const o=this.flattenData([t]);t._level=a?a._level+1:0,o.forEach(i=>i._level=i._parent?i._parent._level+1:0),this.flatData.splice(l,0,...o),this.updateMovingNodeStatus(t)}updateMovingNodeStatus(t){this.checkNodeUpward(t),this.triggerCheckedChange(),t.selected&&this.setSelected(t[this.options.keyField],!0)}filter(t,a){const n=[];this.flatData.forEach(l=>{l._filterVisible=l._parent&&l._parent._filterVisible||a(t,l),l.visible=l._filterVisible,l._filterVisible&&n.push(l)}),n.forEach(l=>{const s=[];let o=l._parent;for(;o;)s.unshift(o),o=o._parent;s.forEach(i=>{i._filterVisible=!0,i.visible=(i._parent===null||i._parent.expand&&i._parent.visible)&&i._filterVisible,this.options.expandOnFilter&&this.setExpand(i[this.options.keyField],!0,!1,!1,!1)}),l.visible=l._parent===null||l._parent.expand&&l._parent.visible}),this.emit("visible-data-change")}setUnloadCheckedKeys(t){this.unloadCheckedKeys=t;const a=t.concat(),n=this.unloadCheckedKeys.length;for(let s=n-1;s>=0;s--){const o=this.unloadCheckedKeys[s];this.mapData[o]&&(this.setChecked(o,!0,!1,!1),this.unloadCheckedKeys.splice(s,1))}const l=this.getCheckedKeys();l.length===a.length&&l.every(s=>a.some(o=>o===s))||this.emit("checked-change",this.getCheckedNodes(),l)}setUnloadSelectedKey(t){const a=this.getSelectedKey();this.mapData[t]?(this.setSelected(t,!0,!1),this.unloadSelectedKey=null):(this.currentSelectedKey&&this.setSelected(this.currentSelectedKey,!1,!1),this.unloadSelectedKey=t);const n=this.getSelectedKey();n!==a&&this.emit("selected-change",this.getSelectedNode(),n)}flattenData(t,a=!0,n=[]){const l=t.length;for(let s=0;s<l;s++){const o=t[s],i=o[this.options.keyField];if(n.push(o),this.mapData[i])throw new Error("[CTree] Duplicate tree node key.");this.mapData[i]=o,o.checked&&this.options.cascade&&(this.checkNodeDownward(o,!0),this.checkNodeUpward(o)),o.selected&&a&&(this.clearSelected(!1,!1),this.currentSelectedKey=o[this.options.keyField],this.emit("selected-change",o,this.currentSelectedKey)),(this.options.defaultExpandAll||o.expand)&&!this.options.load&&!o.isLeaf&&(o.expand=!1,this.setExpand(o[this.options.keyField],!0,!1,!1,!1)),o.children.length&&this.flattenData(o.children,a,n)}return n}checkNodeDownward(t,a,n=!1){if(t.children.forEach(l=>{this.checkNodeDownward(l,a,n)}),t.isLeaf||this.options.load&&!t.children.length){if(!t.disabled){if(n&&!this.options.filteredNodeCheckable&&!t._filterVisible)return;t.checked=a,t.indeterminate=!1}}else this.checkParentNode(t)}checkNodeUpward(t){let a=t._parent;for(;a;)this.checkParentNode(a),a=a._parent}checkParentNode(t){const a=t.children.length;if(!a)return;let n=!1,l=!1,s=!1;for(let o=0;o<a;o++){const i=t.children[o];if(i.checked?n=!0:l=!0,n&&l||i.indeterminate){s=!0,t.checked=!1,t.indeterminate=!0;break}}s||(t.checked=n,t.indeterminate=!1)}findIndex(t,a=this.flatData){if(a!==null){let n=t instanceof ee?t[this.options.keyField]:t;const l=a.length;for(let s=0;s<l;s++)if(a[0]instanceof ee){if(n===a[s][this.options.keyField])return s}else if(n===a[s])return s}return-1}on(t,a){this.listenersMap[t]||(this.listenersMap[t]=[]);let n=[];Array.isArray(a)?n=a:n=[a],n.forEach(l=>{this.listenersMap[t].indexOf(l)===-1&&this.listenersMap[t].push(l)})}off(t,a){if(this.listenersMap[t])if(!a)this.listenersMap[t]=[];else{const n=this.listenersMap[t].indexOf(a);n>-1&&this.listenersMap[t].splice(n,1)}}emit(t,...a){if(!this.listenersMap[t])return;const n=this.listenersMap[t].length;for(let l=0;l<n;l++)this.listenersMap[t][l](...a)}disposeListeners(){for(const t in this.listenersMap)this.listenersMap[t]=[]}}const Lt=oe({name:"CLoadingIcon"}),be=(e,t)=>{const a=e.__vccOpts||e;for(const[n,l]of t)a[n]=l;return a},Tt={viewBox:"0 0 50 50"},Ot=K("circle",{class:"ctree-loading-icon__circle",cx:"25",cy:"25",r:"20",fill:"none","stroke-width":"5","stroke-miterlimit":"10"},null,-1),Rt=[Ot];function Ht(e,t,a,n,l,s){return R(),X("svg",Tt,Rt)}const mt=be(Lt,[["render",Ht]]),w="ctree-tree-node",Pt=oe({name:"CTreeNode",components:{LoadingIcon:mt},props:{data:Object,titleField:{type:String,default:""},keyField:String,render:Function,checkable:Boolean,selectable:Boolean,unselectOnClick:Boolean,disableAll:Boolean,draggable:Boolean,droppable:Boolean,getNode:Function},emits:[...Ve],setup(e,{emit:t}){var a;const n=m(!1),l=m(!1),s=m(!1),o=e.keyField,i=e.getNode,u=f(()=>{var h,p,N,S,$;return[`${w}__wrapper`,{[`${w}__wrapper_is-leaf`]:(h=e.data)==null?void 0:h.isLeaf,[`${w}_disabled`]:e.disableAll||((p=e.data)==null?void 0:p.disabled)},{[`${w}_checked`]:e.checkable&&((N=e.data)==null?void 0:N.checked),[`${w}_indeterminate`]:e.checkable&&((S=e.data)==null?void 0:S.indeterminate)},{[`${w}_selected`]:($=e.data)==null?void 0:$.selected}]}),k=f(()=>[`${w}__node-body`,{[`${w}__drop_active`]:n.value}]),D=f(()=>[`${w}__drop`,{[`${w}__drop_active`]:l.value}]),C=f(()=>[`${w}__drop`,{[`${w}__drop_active`]:s.value}]),M=f(()=>[`${w}__square`,`${w}__checkbox_wrapper`]),Y=f(()=>{var h;return[`${w}__square`,`${w}__expand`,{[`${w}__expand_active`]:(h=e.data)==null?void 0:h.expand}]}),z=f(()=>[`${w}__loading-icon`]),H=f(()=>{var h,p,N;return[`${w}__checkbox`,{[`${w}__checkbox_checked`]:(h=e.data)==null?void 0:h.checked,[`${w}__checkbox_indeterminate`]:(p=e.data)==null?void 0:p.indeterminate,[`${w}__checkbox_disabled`]:e.disableAll||((N=e.data)==null?void 0:N.disabled)}]}),U=f(()=>{var h,p;return[`${w}__title`,{[`${w}__title_selected`]:(h=e.data)==null?void 0:h.selected,[`${w}__title_disabled`]:e.disableAll||((p=e.data)==null?void 0:p.disabled)}]}),b=f(()=>i(e.data?e.data[o]:"")||e.data||{}),I=f(()=>e.checkable),L=((a=e.data)==null?void 0:a.render)||e.render||null,te=f(()=>oe({name:"Render",functional:!0,render(){return typeof L!="function"?Nt("div"):L(b.value)}})),ae=f(()=>{var h;let p={};return e.draggable&&!e.disableAll&&!((h=e.data)!=null&&h.disabled)&&(p={dragstart:V}),p}),G=f(()=>{let h={};return e.droppable&&(h={dragenter:c.bind(ue()),dragover:O.bind(ue()),dragleave:_.bind(ue()),drop:A.bind(ue())}),h});function W(){var h;(h=e.data)!=null&&h.isLeaf||t("expand",b.value)}function Q(){var h;e.disableAll||(h=e.data)!=null&&h.disabled||!e.checkable||t("check",b.value)}function Z(h){var p,N;if(t("click",b.value,h),e.selectable){if(e.disableAll||(p=e.data)!=null&&p.disabled||(N=e.data)!=null&&N.selected&&!e.unselectOnClick)return;t("select",b.value)}else e.checkable?Q():W()}function ne(h){t("node-dblclick",b.value,h)}function le(h){t("node-right-click",b.value,h)}const q=m();function g(h){const p=q.value.getBoundingClientRect(),N=p.height,S=h.clientY-p.top;return S<=N*.3?J.before:S<=N*(.3+.4)?J.body:J.after}function y(h,p=!1){l.value=!1,n.value=!1,s.value=!1,p||(h===J.before?l.value=!0:h===J.body?n.value=!0:h===J.after&&(s.value=!0))}function V(h){var p;h.dataTransfer&&h.dataTransfer.setData("node",JSON.stringify(e.data)),(p=e.data)!=null&&p.expand&&W(),t("node-dragstart",b.value,h)}function c(h){h.preventDefault();const p=g(h);y(p),t("node-dragenter",b.value,h,p)}function O(h){h.preventDefault();const p=g(h);y(p),t("node-dragover",b.value,h,p)}function _(h){const p=g(h);y(p,!0),t("node-dragleave",b.value,h,p)}function A(h){const p=g(h);y(p,!0),t("node-drop",b.value,h,p)}return{dragoverBody:n,dragoverBefore:l,dragoverAfter:s,wrapperCls:u,nodeBodyCls:k,dropBeforeCls:D,dropAfterCls:C,checkboxWrapperCls:M,expandCls:Y,loadingIconCls:z,checkboxCls:H,titleCls:U,fullData:b,showCheckbox:I,renderFunction:L,renderComponent:te,dragListeners:ae,dropListeners:G,handleExpand:W,handleCheck:Q,handleSelect:Z,handleDblclick:ne,handleRightClick:le,nodeBody:q}}}),Ut=["draggable"];function Wt(e,t,a,n,l,s){var o,i,u,k;const D=ke("LoadingIcon");return R(),X("div",{class:x(e.wrapperCls)},[K("div",{class:x(e.dropBeforeCls)},null,2),K("div",ve({ref:"nodeBody",class:e.nodeBodyCls},Be(e.dropListeners,!0)),[K("div",{class:x(e.expandCls)},[ye(K("i",{onClick:t[0]||(t[0]=(...C)=>e.handleExpand&&e.handleExpand(...C))},null,512),[[Fe,!((o=e.data)!=null&&o.isLeaf)&&!((i=e.data)!=null&&i._loading)]]),(u=e.data)!=null&&u._loading?(R(),Ee(D,{key:0,class:x(e.loadingIconCls)},null,8,["class"])):ie("",!0)],2),e.showCheckbox?(R(),X("div",{key:0,class:x(e.checkboxWrapperCls)},[K("div",{class:x(e.checkboxCls),onClick:t[1]||(t[1]=(...C)=>e.handleCheck&&e.handleCheck(...C))},null,2)],2)):ie("",!0),K("div",ve({class:e.titleCls,onClick:t[2]||(t[2]=(...C)=>e.handleSelect&&e.handleSelect(...C)),onDblclick:t[3]||(t[3]=(...C)=>e.handleDblclick&&e.handleDblclick(...C)),onContextmenu:t[4]||(t[4]=(...C)=>e.handleRightClick&&e.handleRightClick(...C))},Be(e.dragListeners,!0),{draggable:e.draggable&&!e.disableAll&&!((k=e.data)!=null&&k.disabled)}),[e.renderFunction?(R(),Ee(xt(e.renderComponent),{key:0})):(R(),X(ft,{key:1},[gt(me(e.data?e.data[e.titleField]:""),1)],64))],16,Ut)],16),K("div",{class:x(e.dropAfterCls)},null,2)],2)}const jt=be(Pt,[["render",Wt]]),ut=["expand","select","unselect","selected-change","check","uncheck","checked-change","set-data"],Jt=["node-drop","check","select","expand"],Xt=oe({name:"CTree",components:{CTreeNode:jt,LoadingIcon:mt},emits:["update:modelValue",...Ve,...ut],props:{modelValue:[String,Number,Array],data:{type:Array,default:()=>[]},unloadDataList:{type:Array,default:()=>[]},showUnloadCheckedNodes:{type:Boolean,default:!0},emptyText:{type:String,default:"暂无数据"},titleField:{type:String,default:"title"},keyField:{type:String,default:"id"},separator:{type:String,default:","},checkable:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},filteredNodeCheckable:{type:Boolean,default:!1},cascade:{type:Boolean,default:!0},enableLeafOnly:{type:Boolean,default:!1},disableAll:{type:Boolean,default:!1},defaultExpandAll:{type:Boolean,default:!1},defaultExpandedKeys:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},draggable:{type:Boolean,default:!1},droppable:{type:Boolean,default:!1},beforeDropMethod:{type:Function,default:()=>()=>!0},ignoreMode:{type:String,default:Ce.none},autoLoad:{type:Boolean,default:!0},load:Function,render:Function,filterMethod:Function,expandOnFilter:{type:Boolean,default:!0},unselectOnClick:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},nodeMinHeight:{type:Number,default:30},nodeIndent:{type:Number,default:20},renderNodeAmount:{type:Number,default:100},bufferNodeAmount:{type:Number,default:20},nodeClassName:{type:[String,Object,Array,Function]}},setup(e,t){const a="ctree-tree",n=(d,r)=>{if(Array.isArray(d)&&Array.isArray(r)){if(d.length===r.length&&d.every(v=>r.some(E=>E===v)))return!0}else if(d===r)return!0;return!1};let l=Me([]),s=m([]);const o=m(0),i=m(0),u=m(0),k=m(0),D=m(0),C=m(0),M=m(0),Y=m(0),z=m(!1),H=m(Array.isArray(e.modelValue)?e.modelValue.concat():e.modelValue),U=m(void 0),b=m(),I=m(),L=f(()=>({height:`${u.value}px`})),te=f(()=>({height:`${k.value}px`})),ae=f(()=>[`${a}__wrapper`]),G=f(()=>[`${a}__scroll-area`]),W=f(()=>[`${a}__block-area`]),Q=f(()=>[`${a}__empty`]),Z=f(()=>[`${a}__empty-text_default`]),ne=f(()=>[`${a}__loading`]),le=f(()=>[`${a}__loading-wrapper`]),q=f(()=>[`${a}__loading-icon`]),g=f(()=>[`${a}__iframe`]),y=Ve.reduce((d,r)=>(Jt.indexOf(r)<0&&(d[r]=(...v)=>{t.emit.apply(t,[r,...v])}),d),{}),V=()=>({store:new It({keyField:e.keyField,ignoreMode:e.ignoreMode,filteredNodeCheckable:e.filteredNodeCheckable,cascade:e.cascade,defaultExpandAll:e.defaultExpandAll,load:e.load,expandOnFilter:e.expandOnFilter}),blockNodes:[]});let c=V();fe(()=>e.modelValue,d=>{if(e.checkable){if(n(d,H.value))return;let r=[];Array.isArray(d)?r=d.concat():typeof d=="string"&&(r=d===""?[]:d.split(e.separator)),c.store.clearChecked(!1,!1),c.store.setCheckedKeys(r,!0)}else if(e.selectable){if(d===H.value)return;const r=c.store.getSelectedKey();d!==""&&d!=null?c.store.setSelected(d,!0):(d===""||d==null)&&r&&c.store.setSelected(r,!1)}}),fe(()=>e.data,d=>{O(d)}),fe(()=>e.expandedKeys,()=>{re()});function O(d){Ke();let r=null,v=null;e.checkable?Array.isArray(e.modelValue)?r=e.modelValue.concat():typeof e.modelValue=="string"&&(r=e.modelValue===""?[]:e.modelValue.split(e.separator)):e.selectable&&!Array.isArray(e.modelValue)&&(v=e.modelValue),c.store.setData(d,v,r),re()}function _(d,r){c.store.setChecked(d,r)}function A(d,r){c.store.setCheckedKeys(d,r)}function h(){c.store.checkAll()}function p(){c.store.clearChecked()}function N(d,r){c.store.setSelected(d,r)}function S(){c.store.clearSelected()}function $(d,r,v=!0){c.store.setExpand(d,r,v)}function Le(d,r){c.store.setExpandKeys(d,r)}function Te(d){c.store.setExpandAll(d)}function Oe(d){return d=d||e.ignoreMode,c.store.getCheckedNodes(d)}function Re(d){return d=d||e.ignoreMode,c.store.getCheckedKeys(d)}function He(){return c.store.getIndeterminateNodes()}function Pe(){return c.store.getSelectedNode()}function Ue(){return c.store.getSelectedKey()}function We(){return c.store.getExpandNodes()}function je(){return c.store.getExpandKeys()}function Je(){return c.store.flatData.filter(d=>d._filterVisible)}function _e(d){return c.store.getNode(d)}function Xe(){return c.store.data}function Ye(){return c.store.flatData}function ze(){return c.store.flatData.length}function Ge(d,r){return c.store.insertBefore(d,r)}function Qe(d,r){return c.store.insertAfter(d,r)}function Ze(d,r){return c.store.append(d,r)}function qe(d,r){return c.store.prepend(d,r)}function et(d){return c.store.remove(d)}function tt(d,r){const v=(E,F)=>{const T=F[e.titleField];return T==null||!T.toString?!1:T.toString().toLowerCase().indexOf(E.toLowerCase())>-1};r=r||e.filterMethod||v,c.store.filter(d,r)}function at(d){if(!e.checkable)return;d=d??e.showUnloadCheckedNodes;const r=c.store.getCheckedNodes();if(c.store.filter("",(E,F)=>F.checked),!d)return;const v=c.store.getUnloadCheckedKeys();if(v.length){const E=v.map(F=>{const T=e.unloadDataList.concat(r);let ct=F;return T.some($e=>$e[e.keyField]===F&&$e[e.titleField]!=null?(ct=$e[e.titleField],!0):!1),new ee({[e.keyField]:F,[e.titleField]:ct,checked:!0,isLeaf:!0},null,e.keyField,!!e.load)});l=E,c.blockNodes.push(...E),ce(),se()}}function Se(){return z.value=!0,new Promise((d,r)=>{e.load&&e.load(null,d,r)}).then(d=>{Array.isArray(d)&&O(d)}).catch(()=>{}).then(()=>{z.value=!1})}function nt(d,r=ge.top){const v=c.store.mapData[d];if(!v||!v.visible)return;let E=-1;for(let T=0;T<o.value;T++)if(c.blockNodes[T][e.keyField]===d){E=T;break}if(E===-1)return;let F=E*e.nodeMinHeight;if(r===ge.center){const T=b.value.clientHeight;F=F-(T-e.nodeMinHeight)/2}else if(r===ge.bottom){const T=b.value.clientHeight;F=F-(T-e.nodeMinHeight)}else typeof r=="number"&&(F=F-r);b.value&&(b.value.scrollTop=F)}function re(){e.expandedKeys.length&&(c.store.setExpandAll(!1,!1),c.store.setExpandKeys(e.expandedKeys,!0))}function Ne(){if(l.length){const d=c.store.getUnloadCheckedKeys();l.forEach(r=>{r.checked=d.indexOf(r[e.keyField])>-1})}}function lt(d){!e.cascade&&e.enableLeafOnly&&!d.isLeaf||c.store.setChecked(d[e.keyField],d.indeterminate?!0:!d.checked,!0,!0,!0)}function st(d){e.enableLeafOnly&&!d.isLeaf||c.store.setSelected(d[e.keyField],!d.selected)}function dt(d){c.store.setExpand(d[e.keyField],!d.expand)}function ot(d,r,v){if(e.droppable&&r.dataTransfer)try{const E=JSON.parse(r.dataTransfer.getData("node"))[e.keyField],F=d[e.keyField];if(e.beforeDropMethod(E,F,v)){if(E===F)return;v===J.before?c.store.insertBefore(E,F):v===J.body||!d.isLeaf&&d.expand?c.store.prepend(E,F):v===J.after&&c.store.insertAfter(E,F),t.emit("node-drop",d,r,v,_e(E))}}catch(E){throw new Error(E)}}function xe(d,r){if(e.checkable){let v=r;Array.isArray(e.modelValue)||(v=v.join(e.separator)),Array.isArray(v)?H.value=v.concat():H.value=v,t.emit("update:modelValue",v)}}function we(d,r){if(e.selectable&&!e.checkable){const v=r||"";H.value=v,t.emit("update:modelValue",v)}}function it(){ut.forEach(d=>{c.store.on(d,(...r)=>{t.emit.apply(t,[d,...r])})})}function Ke(){u.value=0,k.value=0,b.value&&(b.value.scrollTop=0)}function De(){c.blockNodes=c.store.flatData.filter(d=>d.visible),ce(),se()}function ce(){o.value=c.blockNodes.length,i.value=e.nodeMinHeight*o.value}function se(){Ae(),he()}function Ae(){const d=b.value.clientHeight;D.value=Math.max(e.renderNodeAmount,Math.ceil(d/e.nodeMinHeight)+e.bufferNodeAmount)}function he(d=!1){if(o.value>D.value){const r=b.value.scrollTop,v=Math.floor(r/e.nodeMinHeight);M.value=Math.floor(v/e.bufferNodeAmount)*e.bufferNodeAmount}else M.value=0;d&&C.value===D.value&&Y.value===M.value||(s.value=c.blockNodes.slice(M.value,M.value+D.value).map(r=>Object.assign({},r,{_parent:null,children:[]})),u.value=M.value*e.nodeMinHeight,k.value=i.value-(u.value+s.value.length*e.nodeMinHeight))}function rt(){U.value&&window.cancelAnimationFrame(U.value),C.value=D.value,Y.value=M.value,U.value=window.requestAnimationFrame(he.bind(null,!0))}const bt={setData:O,setChecked:_,setCheckedKeys:A,checkAll:h,clearChecked:p,setSelected:N,clearSelected:S,setExpand:$,setExpandKeys:Le,setExpandAll:Te,getCheckedNodes:Oe,getCheckedKeys:Re,getIndeterminateNodes:He,getSelectedNode:Pe,getSelectedKey:Ue,getExpandNodes:We,getExpandKeys:je,getCurrentVisibleNodes:Je,getTreeData:Xe,getFlatData:Ye,getNodesCount:ze,insertBefore:Ge,insertAfter:Qe,append:Ze,prepend:qe,remove:et,filter:tt,showCheckedNodes:at,loadRootNodes:Se,scrollTo:nt,updateExpandedKeys:re,updateUnloadStatus:Ne,handleTreeScroll:rt,handleNodeCheck:lt,handleNodeSelect:st,handleNodeExpand:dt,handleNodeDrop:ot,emitCheckableInput:xe,emitSelectableInput:we,resetSpaceHeights:Ke,updateBlockNodes:De,updateBlockData:ce,updateRender:se,updateRenderAmount:Ae,updateRenderNodes:he,getNode:_e};return Ie(()=>{c.store.on("visible-data-change",De),c.store.on("render-data-change",se),c.store.on("checked-change",(r,v)=>{xe(r,v),Ne()}),c.store.on("selected-change",we),e.data.length?(O(e.data),e.defaultExpandedKeys.length&&c.store.setExpandKeys(e.defaultExpandedKeys,!0)):typeof e.load=="function"&&e.autoLoad&&((e.modelValue||e.unloadDataList)&&O([]),Se());const d=I.value;d!=null&&d.contentWindow&&d.contentWindow.addEventListener("resize",se)}),_t(()=>{const d=I.value;d!=null&&d.contentWindow&&d.contentWindow.removeEventListener("resize",se),c.store.disposeListeners();const r=V();c.store=r.store,c.blockNodes=r.blockNodes}),it(),{nonReactive:c,unloadCheckedNodes:l,blockLength:o,blockAreaHeight:i,topSpaceHeight:u,bottomSpaceHeight:k,renderAmount:D,renderAmountCache:C,renderNodes:s,renderStart:M,renderStartCache:Y,isRootLoading:z,valueCache:H,debounceTimer:U,topSpaceStyles:L,bottomSpaceStyles:te,wrapperCls:ae,scrollAreaCls:G,blockAreaCls:W,emptyCls:Q,emptyTextDefaultCls:Z,loadingCls:ne,loadingWrapperCls:le,loadingIconCls:q,iframeCls:g,treeNodeListeners:y,setData:O,setChecked:_,setCheckedKeys:A,checkAll:h,clearChecked:p,setSelected:N,clearSelected:S,setExpand:$,setExpandKeys:Le,setExpandAll:Te,getCheckedNodes:Oe,getCheckedKeys:Re,getIndeterminateNodes:He,getSelectedNode:Pe,getSelectedKey:Ue,getExpandNodes:We,getExpandKeys:je,getCurrentVisibleNodes:Je,getTreeData:Xe,getFlatData:Ye,getNodesCount:ze,insertBefore:Ge,insertAfter:Qe,append:Ze,prepend:qe,remove:et,filter:tt,showCheckedNodes:at,loadRootNodes:Se,scrollTo:nt,updateExpandedKeys:re,updateUnloadStatus:Ne,handleTreeScroll:rt,handleNodeCheck:lt,handleNodeSelect:st,handleNodeExpand:dt,handleNodeDrop:ot,emitCheckableInput:xe,emitSelectableInput:we,attachStoreEvents:it,resetSpaceHeights:Ke,updateBlockNodes:De,updateBlockData:ce,updateRender:se,updateRenderAmount:Ae,updateRenderNodes:he,getNode:_e,scrollArea:b,iframe:I,methods:bt}}});function Yt(e,t,a,n,l,s){const o=ke("CTreeNode"),i=ke("LoadingIcon");return R(),X("div",{class:x(e.wrapperCls)},[K("div",{ref:"scrollArea",class:x(e.scrollAreaCls),onScrollPassive:t[0]||(t[0]=wt((...u)=>e.handleTreeScroll&&e.handleTreeScroll(...u),["stop"]))},[K("div",{class:x(e.blockAreaCls)},[K("div",{style:ht(e.topSpaceStyles)},null,4),(R(!0),X(ft,null,kt(e.renderNodes,u=>(R(),Ee(o,ve(e.$props,{key:u[e.keyField],data:u,getNode:e.getNode},Be(e.treeNodeListeners),{class:typeof e.nodeClassName=="function"?e.nodeClassName(u):e.nodeClassName,style:{minHeight:`${e.nodeMinHeight}px`,paddingLeft:`${u._level*e.nodeIndent}px`},onCheck:e.handleNodeCheck,onSelect:e.handleNodeSelect,onExpand:e.handleNodeExpand,onNodeDrop:e.handleNodeDrop}),null,16,["data","getNode","class","style","onCheck","onSelect","onExpand","onNodeDrop"]))),128)),K("div",{style:ht(e.bottomSpaceStyles)},null,4)],2)],34),ye(K("div",{class:x(e.emptyCls)},[K("span",{class:x(e.emptyTextDefaultCls)},[de(e.$slots,"empty",{},()=>[gt(me(e.emptyText),1)])],2)],2),[[Fe,!e.blockLength]]),ye(K("div",{class:x(e.loadingCls)},[K("div",{class:x(e.loadingWrapperCls)},[de(e.$slots,"loading",{},()=>[yt(i,{class:x(e.loadingIconCls)},null,8,["class"])])],2)],2),[[Fe,e.loading||e.isRootLoading]]),K("iframe",{ref:"iframe",class:x(e.iframeCls)},null,2)],2)}const zt=be(Xt,[["render",Yt]]);function Ct(e){return Mt.reduce((t,a)=>(t[a]=function(...n){return e.value[a].apply(e.value,n)},t),{})}const P="ctree-tree-search",pe="ctree-tree-node",Gt=oe({name:"CTreeSearch",inheritAttrs:!1,emits:["checked-change","search","set-data","update:modelValue"],components:{CTree:zt},props:{modelValue:[String,Number,Array],searchPlaceholder:{type:String,default:"搜索关键字"},showCheckAll:{type:Boolean,default:!0},showCheckedButton:{type:Boolean,default:!0},checkedButtonText:{type:String,default:"已选"},showFooter:{type:Boolean,default:!0},searchMethod:Function,searchLength:{type:Number,default:1},searchDisabled:{type:Boolean,default:!1},searchRemote:{type:Boolean,default:!1},searchDebounceTime:{type:Number,default:300}},setup(e,{emit:t,attrs:a,expose:n}){const l=Me({checked:!1,indeterminate:!1,disabled:!1}),s=m(!1),o=m(""),i=m(void 0),u=m(0),k=m();let D=Ct(k);const C=f({get:()=>e.modelValue,set:_=>{V(),t("update:modelValue",_)}}),M=f(()=>[`${P}__wrapper`]),Y=f(()=>[`${P}__search`]),z=f(()=>[`${P}__check-all-wrapper`]),H=f(()=>[`${P}__check-all`,`${pe}__checkbox`,{[`${pe}__checkbox_checked`]:l.checked,[`${pe}__checkbox_indeterminate`]:l.indeterminate,[`${pe}__checkbox_disabled`]:e.searchDisabled||l.disabled}]),U=f(()=>[`${P}__input-wrapper`]),b=f(()=>[`${P}__input`,{[`${P}__input_disabled`]:e.searchDisabled}]),I=f(()=>[`${P}__action-wrapper`]),L=f(()=>[`${P}__checked-button`,{[`${P}__checked-button_active`]:s.value}]),te=f(()=>[`${P}__tree-wrapper`]),ae=f(()=>[`${P}__footer`]),G=f(()=>"checkable"in a&&a.checkable!==!1);function W(){o.value=""}function Q(){return o.value}function Z(_){let A=_;return typeof _!="string"&&(A=o.value),new Promise((h,p)=>{clearTimeout(i.value),i.value=setTimeout(()=>{if(!(A.length>0&&A.length<e.searchLength))if(s.value=!1,t("search",A),typeof e.searchMethod=="function"){const N=e.searchMethod(A);Promise.resolve(N).then(()=>{y(),h()})}else e.searchRemote?k.value.loadRootNodes().then(()=>{y(),h()}):(k.value.filter(A),y(),h())},e.searchDebounceTime)})}function ne(){if(e.searchDisabled||l.disabled)return;const _=k.value.getCurrentVisibleNodes().map(A=>A[k.value.keyField]);l.checked||l.indeterminate?k.value.setCheckedKeys(_,!1):k.value.setCheckedKeys(_,!0),y()}function le(){Z()}function q(){const _=()=>{s.value=!s.value,s.value?k.value.showCheckedNodes():k.value.filter(o.value,()=>!0),y()};o.value?(W(),Z().then(()=>{_()})):_()}function g(){V(),y()}function y(){const _=k.value.getCurrentVisibleNodes(),A=_.length;let h=!1,p=!1,N=!1;for(let S=0;S<A;S++){const $=_[S];if($.checked?h=!0:p=!0,h&&p||$.indeterminate){N=!0,l.checked=!1,l.indeterminate=!0;break}}N||(l.checked=h,l.indeterminate=!1)}function V(){u.value=k.value.getCheckedKeys().length}function c(_,A){y(),t("checked-change",_,A)}function O(){t("set-data"),g()}return Ie(()=>{G.value&&!u.value&&g()}),{...D,treeModelValue:C,setChecked:(_,A)=>{k.value.setChecked(_,A)},checkAllStatus:l,isShowingChecked:s,keyword:o,debounceTimer:i,checkedCount:u,wrapperCls:M,searchCls:Y,checkAllWrapperCls:z,checkboxCls:H,inputWrapperCls:U,inputCls:b,actionWrapperCls:I,checkedButtonCls:L,treeWrapperCls:te,footerCls:ae,checkable:G,treeRef:k,handleCheckAll:ne,handleSearch:le,handleShowChecked:q,updateCheckedCount:V,handleSetData:g,updateCheckAllStatus:y,getKeyword:Q,checkedChange:c,onSetData:O,clearKeyword:W,search:Z}}}),Qt=["placeholder","disabled"],Zt={style:{float:"right"}};function qt(e,t,a,n,l,s){const o=ke("CTree");return R(),X("div",{class:x(e.wrapperCls)},[K("div",{class:x(e.searchCls)},[e.showCheckAll&&e.checkable?(R(),X("div",{key:0,class:x(e.checkAllWrapperCls)},[K("div",{class:x(e.checkboxCls),onClick:t[0]||(t[0]=(...i)=>e.handleCheckAll&&e.handleCheckAll(...i))},null,2)],2)):ie("",!0),K("div",{class:x(e.inputWrapperCls)},[de(e.$slots,"search-input",{},()=>[ye(K("input",{"onUpdate:modelValue":t[1]||(t[1]=i=>e.keyword=i),type:"text",class:x(e.inputCls),placeholder:e.searchPlaceholder,disabled:e.searchDisabled,onInput:t[2]||(t[2]=(...i)=>e.handleSearch&&e.handleSearch(...i))},null,42,Qt),[[Kt,e.keyword]])])],2),K("div",{class:x(e.actionWrapperCls)},[e.showCheckedButton&&e.checkable?(R(),X("span",{key:0,class:x(e.checkedButtonCls),onClick:t[3]||(t[3]=(...i)=>e.handleShowChecked&&e.handleShowChecked(...i))},me(e.checkedButtonText),3)):ie("",!0),de(e.$slots,"actions")],2)],2),K("div",{class:x(e.treeWrapperCls)},[yt(o,ve({ref:"treeRef"},e.$attrs,{modelValue:e.treeModelValue,"onUpdate:modelValue":t[4]||(t[4]=i=>e.treeModelValue=i),onSetData:e.onSetData,onCheckedChange:e.checkedChange}),Dt({_:2},[kt(e.$slots,(i,u)=>({name:"default",fn:At(k=>[de(e.$slots,u,$t(Ft(k)))])}))]),1040,["modelValue","onSetData","onCheckedChange"])],2),e.showFooter&&e.checkable?(R(),X("div",{key:0,class:x(e.footerCls)},[de(e.$slots,"footer",{},()=>[K("span",Zt,"已选 "+me(e.checkedCount)+" 个",1)])],2)):ie("",!0)],2)}const ea=be(Gt,[["render",qt]]),j="ctree-tree-drop",pt="ctree-tree-search";oe({name:"CTreeDrop",inheritAttrs:!1,emits:["clear","checked-change","dropdown-visible-change","update:modelValue"],components:{CTreeSearch:ea},props:{modelValue:[String,Number,Array],dropHeight:{type:Number,default:300},dropPlaceholder:{type:String},dropDisabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placement:{type:String,default:vt["bottom-start"]},transfer:{type:Boolean,default:!1},dropdownClassName:[String,Array],dropdownMinWidth:{type:Number},dropdownWidthFixed:{type:Boolean,default:!1}},setup(e,{attrs:t,emit:a}){const n=m(!1),l=m(0),s=m(""),o=m(),i=m(),u=m(),k=Me({checkedNodes:[],checkedKeys:[],selectedNode:void 0,selectedKey:void 0}),D=f({get:()=>e.modelValue,set:g=>{a("update:modelValue",g)}}),C=f(()=>[`${j}__wrapper`]),M=f(()=>[`${j}__reference`]),Y=f(()=>[`${pt}__input`,`${j}__display-input`,{[`${j}__display-input_focus`]:n.value,[`${pt}__input_disabled`]:e.dropDisabled}]),z=f(()=>{let g=!1;return typeof e.dropPlaceholder=="string"&&(I.value?g=l.value===0:L.value&&(g=s.value==="")),[`${j}__display-input-text`,{[`${j}__display-input-placeholder`]:g}]}),H=f(()=>[`${j}__display-icon-drop`,{[`${j}__display-icon-drop_active`]:n.value}]),U=f(()=>[`${j}__display-icon-clear`]),b=f(()=>{const g=Array.isArray(e.dropdownClassName)?e.dropdownClassName:[e.dropdownClassName];return[`${j}__dropdown`,...g]}),I=f(()=>"checkable"in t&&t.checkable!==!1),L=f(()=>"selectable"in t&&t.selectable!==!1),te=f(()=>I.value?l.value===0&&typeof e.dropPlaceholder=="string"?e.dropPlaceholder:`已选 ${l.value} 个`:L.value?s.value===""&&typeof e.dropPlaceholder=="string"?e.dropPlaceholder:s.value:e.dropPlaceholder||""),ae=f(()=>I.value?l.value!==0:L.value?s.value!=="":!1);function G(){const g=o.value.getBoundingClientRect(),y=g.width,V=g.height,c=`${typeof e.dropdownMinWidth=="number"?e.dropdownMinWidth:y}px`;i.value.style.minWidth=c,i.value.style.width=e.dropdownWidthFixed?c:"auto";const O=i.value.getBoundingClientRect(),_=window.getComputedStyle(i.value),A=parseFloat(_.marginLeft)+parseFloat(_.marginRight),h=parseFloat(_.marginTop)+parseFloat(_.marginBottom),p=O.width+A,N=O.height/.8+h;let S=0,$=0;switch(e.transfer&&(S=-999,$=-999),e.placement){case"bottom-start":e.transfer?(S=window.pageYOffset+g.bottom,$=window.pageXOffset+g.left):S=V;break;case"bottom-end":e.transfer?(S=window.pageYOffset+g.bottom,$=window.pageXOffset+g.right-p):(S=V,$=y-p);break;case"bottom":e.transfer?(S=window.pageYOffset+g.bottom,$=window.pageXOffset+g.left+(y-p)/2):(S=V,$=(y-p)/2);break;case"top-start":e.transfer?(S=window.pageYOffset+g.top-N,$=window.pageXOffset+g.left):S=-N;break;case"top-end":e.transfer?(S=window.pageYOffset+g.top-N,$=window.pageXOffset+g.right-p):(S=-N,$=y-p);break;case"top":e.transfer?(S=window.pageYOffset+g.top-N,$=window.pageXOffset+g.left+(y-p)/2):(S=-N,$=(y-p)/2);break}i.value.style.top=`${S}px`,i.value.style.left=`${$}px`}function W(){e.dropDisabled||(n.value=!n.value)}function Q(g){var y,V;!((y=o.value)!=null&&y.contains(g.target))&&!((V=i.value)!=null&&V.contains(g.target))&&(n.value=!1)}function Z(){a("clear"),I.value?u.value.clearChecked():L.value&&u.value.clearSelected()}function ne(g,y){k.checkedNodes=g,k.checkedKeys=y,l.value=y.length,a("checked-change",g,y)}function le(g,y){if(k.selectedNode=g,k.selectedKey=y,g){const V=u.value.$refs.treeRef.titleField;s.value=g[V]}else y?s.value=y:s.value="";n.value=!1}function q(){const g=u.value.$refs.treeRef;if(k.checkedNodes=u.value.getCheckedNodes(),k.checkedKeys=u.value.getCheckedKeys(),k.selectedNode=u.value.getSelectedNode(),k.selectedKey=u.value.getSelectedKey(),I.value&&(l.value=k.checkedKeys.length),L.value&&e.modelValue!=null){const y=u.value.getNode(e.modelValue);if(y){const V=g.titleField;s.value=y[V]}else s.value=e.modelValue}}return Ie(()=>{document.addEventListener("click",Q),e.transfer&&document.body.appendChild(i.value),q()}),fe(()=>n.value,g=>{a("dropdown-visible-change",g),g?St(()=>{G()}):u.value.getKeyword()&&(u.value.clearKeyword(),u.value.search())}),{...Ct(u),treeSearchValue:D,dropdownVisible:n,checkedCount:l,selectedTitle:s,slotProps:k,wrapperCls:C,referenceCls:M,displayInputCls:Y,displayInputTextCls:z,dropIconCls:H,clearIconCls:U,dropdownCls:b,checkable:I,selectable:L,displayValue:te,showClearIcon:ae,referenceRef:o,dropdownRef:i,treeSearchRef:u,locateDropdown:G,handleRefClick:W,handleDocumentClick:Q,handleClear:Z,handleCheckedChange:ne,handleSelectedChange:le,handleSetData:q}}});export{zt as J};
