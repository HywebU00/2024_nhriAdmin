import{J as F}from"./style-150b916b.js";import{_ as S,u as P,m as R,r as c,o as m,c as f,b as d,t as b,d as i,e,w as l,f as B,F as y,a as M,g as U,i as T}from"./index-d49e1aec.js";P();const z={components:{VTree:F},computed:{...R(M,["apiServerUrl","apiToken"])},data(){return{dialog1:!1,dialog2:!1,dialog3:!1,edidFlag:!0,selectedData:null,targetItem:null,treeData:null,headers:[{title:"帳號",key:"userId",width:30,sortable:!0,removable:!0},{title:"姓名",key:"userName",width:40,sortable:!0,removable:!0},{title:"單位",key:"deptName",width:100,sortable:!1,removable:!0},{title:"職稱",key:"jobTitle",width:50,sortable:!1,removable:!0},{title:"角色",key:"roleName",width:80,sortable:!1,removable:!0},{title:"狀態",key:"active",width:20,sortable:!1,removable:!0},{title:"編輯",key:"action",width:80,sortable:!1,removable:!0}],tableData:[],options:{},loading:!1,itemsPerPageArray:[5,30,50],currentPage:1,itemsPerPage:5,maxPage:0,totalItems:2,nodes:{},basicUsage:{}}},methods:{parentDialog(){this.dialog1=!1,this.dialog2=!1,this.dialog3=!1},handleSelectNode(o){let t=this;console.log("!!!!!!!!!!!!!!!!",o);var u=t.treeData.find(n=>n.uuid==o);console.log("!!!!!!!!!!!!!!!!",u),u.depth!="0"?(t.targetItem=u,t.edidFlag=u.depth!="1"):t.targetItem=null,console.log(t.targetItem)},organizeArray(o){const t=[],u={};return o=o.filter(function(n){return n.uuid!=="external_committee"}),o.forEach(n=>{n.parentUuid=n.parentDept?n.parentDept.uuid:null,n.title=n.depth!=0?n.deptId+n.name:n.name,n.children=[],u[n.uuid]=n}),o.sort(function(n,a){return n.depth!==a.depth?n.depth-a.depth:n.priority-a.priority}),o.forEach(n=>{const a=n.parentUuid;if(a){const p=u[a];p&&p.children.push(n)}else t.push(n)}),console.log("result ",t),t},convertToHierarchy(o){function t(u){return{title:u.name,id:u.uuid,children:u.children?u.children.map(t):[]}}return!o||o.length===0?null:t(o[0])},handleAdd(){this.$refs.basicTreeRef.insertAfter({},this.targetItem.uuid)},handleAddChild(){this.$refs.basicTreeRef.append({},this.targetItem.uuid)},handleRemove(){this.$refs.basicTreeRef.remove(this.targetItem.uuid),this.targetItem=null},getChild(){let o=this;o.loading=!0,console.log("apiToken ",this.apiToken),o.axios.get(this.apiServerUrl+"nhri/getAllDepts",{headers:{"Content-Type":"application/json",Authorization:this.apiToken}}).then(function(t){o.treeData=t.data,o.basicUsage=o.organizeArray(t.data),JSON.stringify(t.data),o.loading=!1}).catch(function(t){console.log(t)}).finally(()=>{o.loading=!1})}},mounted(){console.log("mounted dept ",this.apiToken),this.getChild()},created(){},watch:{selectedData(o){this.handleSelectNode(o)}}},E={class:"breadcrumb float-xl-end"},J={class:"breadcrumb-item"},O={class:"page-header"},H=d("small",null,null,-1),L=d("small",{class:"text-primary"},'檔案更新 > 需新增 class="treeComponent" ',-1),q={class:"row mb-3"},G={class:"col-xl-4"},K={key:0,class:"col-xl-8"},Q={key:0},W={key:1},X={class:"my-n1"},Y=d("label",{class:"form-label"}," 上層單位 ",-1),Z={for:"",class:"ml-4"},j=d("label",{class:"form-label"},[d("abbr",{class:"necessary",title:"為必填(選)欄位,不能為空白。"},"* "),i("單位名稱 ")],-1),$=d("label",{class:"form-label"},[d("abbr",{class:"necessary",title:"為必填(選)欄位,不能為空白。"},"* "),i("單位代碼(二碼) ")],-1),ee=d("label",{class:"form-label"},[d("abbr",{class:"necessary",title:"為必填(選)欄位,不能為空白。"},"* "),i("單位主管 ")],-1),te=d("label",{class:"form-label"},[d("abbr",{class:"necessary",title:"為必填(選)欄位,不能為空白。"},"* "),i("順序 ")],-1),le=d("label",{class:"form-label"}," 描述 ",-1),ae=d("label",{class:"form-label"},[d("abbr",{class:"necessary",title:"為必填(選)欄位,不能為空白。"},"* "),i("送至上層單位簽核 ")],-1),oe=d("label",{class:"form-label"},[d("abbr",{class:"necessary",title:"為必填(選)欄位,不能為空白。"},"* "),i("狀態 ")],-1);function se(o,t,u,n,a,p){const V=c("panel-title"),I=c("panel-header"),D=c("VTree"),x=c("panel-body"),k=c("panel"),_=c("v-radio"),v=c("v-radio-group"),r=c("v-col"),g=c("v-text-field"),N=c("v-autocomplete"),C=c("v-row"),h=c("v-btn"),w=c("v-container");return m(),f(y,null,[d("ol",E,[d("li",J,b(o.$route.meta.parentPathName)+b(o.$route.name),1)]),d("h1",O,[i(b(o.$route.name)+" ",1),H]),L,d("div",q,[d("div",G,[e(k,null,{default:l(()=>[e(I,null,{default:l(()=>[e(V,null,{default:l(()=>[i(" 組織樹 ")]),_:1})]),_:1}),e(x,null,{default:l(()=>[e(D,{class:"treeComponent",ref:"basicTreeRef",data:a.basicUsage,loading:a.loading,emptyText:"",titleField:"title",keyField:"uuid",nodeClassName:s=>`generated-class-${s.id}`,modelValue:a.selectedData,"onUpdate:modelValue":t[0]||(t[0]=s=>a.selectedData=s),selectable:""},null,8,["data","loading","nodeClassName","modelValue"])]),_:1})]),_:1})]),a.targetItem?(m(),f("div",K,[e(k,null,{default:l(()=>[e(I,null,{default:l(()=>[e(V,null,{default:l(()=>[a.edidFlag?(m(),f("span",Q,"修改單位")):(m(),f("span",W,"新增單位"))]),_:1}),d("div",X,[e(v,{modelValue:a.edidFlag,"onUpdate:modelValue":t[1]||(t[1]=s=>a.edidFlag=s),"hide-details":"auto",inline:"",density:"compact"},{default:l(()=>[e(_,{label:"修改單位",value:!0}),e(_,{label:"新增單位",value:!1})]),_:1},8,["modelValue"])])]),_:1}),e(x,null,{default:l(()=>[e(w,{class:"tableInfo"},{default:l(()=>[e(C,null,{default:l(()=>[e(r,{cols:"3",class:"text-right bg-thead thead"},{default:l(()=>[Y]),_:1}),e(r,{cols:"7"},{default:l(()=>[d("label",Z,b(a.targetItem.parentUuid),1)]),_:1}),e(r,{cols:"3",class:"text-right bg-thead thead"},{default:l(()=>[j]),_:1}),e(r,{cols:"7"},{default:l(()=>[e(g,{modelValue:a.targetItem.name,"onUpdate:modelValue":t[2]||(t[2]=s=>a.targetItem.name=s),variant:"outlined",density:"compact","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(r,{cols:"3",class:"text-right bg-thead thead"},{default:l(()=>[$]),_:1}),e(r,{cols:"7"},{default:l(()=>[e(g,{modelValue:a.targetItem.deptId,"onUpdate:modelValue":t[3]||(t[3]=s=>a.targetItem.deptId=s),variant:"outlined",density:"compact","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(r,{cols:"3",class:"text-right bg-thead thead"},{default:l(()=>[ee]),_:1}),e(r,{cols:"7"},{default:l(()=>[e(N,{modelValue:a.targetItem.chief,"onUpdate:modelValue":t[4]||(t[4]=s=>a.targetItem.chief=s),variant:"outlined",density:"compact","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(r,{cols:"3",class:"text-right bg-thead thead"},{default:l(()=>[te]),_:1}),e(r,{cols:"7"},{default:l(()=>[e(g,{modelValue:a.targetItem.priority,"onUpdate:modelValue":t[5]||(t[5]=s=>a.targetItem.priority=s),variant:"outlined",density:"compact","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(r,{cols:"3",class:"text-right bg-thead thead"},{default:l(()=>[le]),_:1}),e(r,{cols:"7"},{default:l(()=>[e(g,{modelValue:a.targetItem.description,"onUpdate:modelValue":t[6]||(t[6]=s=>a.targetItem.description=s),variant:"outlined",density:"compact","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(r,{cols:"3",class:"text-right bg-thead thead"},{default:l(()=>[ae]),_:1}),e(r,{cols:"7"},{default:l(()=>[e(v,{modelValue:a.targetItem.upper_certify,"onUpdate:modelValue":t[7]||(t[7]=s=>a.targetItem.upper_certify=s),"hide-details":"auto",inline:"",density:"compact"},{default:l(()=>[(m(!0),f(y,null,U(o.$globalModels.getCommonArrayUtil("yesFlag"),(s,A)=>(m(),T(_,{label:s.label,value:s.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(r,{cols:"3",class:"text-right bg-thead thead"},{default:l(()=>[oe]),_:1}),e(r,{cols:"7"},{default:l(()=>[e(v,{modelValue:a.targetItem.status,"onUpdate:modelValue":t[8]||(t[8]=s=>a.targetItem.status=s),"hide-details":"auto",inline:"",density:"compact"},{default:l(()=>[(m(!0),f(y,null,U(o.$globalModels.getCommonArrayUtil("activeFlag"),(s,A)=>(m(),T(_,{label:s.label,value:s.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(C,{class:"mt-4"},{default:l(()=>[e(r,{class:"justify-center d-flex"},{default:l(()=>[e(h,{class:"mx-1",color:"primary",variant:"elevated",onClick:p.handleAdd},{default:l(()=>[i(" addTest ")]),_:1},8,["onClick"]),e(h,{class:"mx-1",color:"secondary",variant:"elevated",onClick:p.handleAddChild},{default:l(()=>[i(" addChildTest ")]),_:1},8,["onClick"]),e(h,{class:"mx-1",color:"danger",variant:"elevated",onClick:p.handleRemove},{default:l(()=>[i(" removeTest ")]),_:1},8,["onClick"]),e(h,{class:"mx-1",color:"submit",variant:"elevated"},{default:l(()=>[i(" 儲存 ")]),_:1}),e(h,{class:"mx-1",color:"cancel",variant:"elevated"},{default:l(()=>[i(" 重置 ")]),_:1}),e(h,{class:"mx-1",color:"cancel",variant:"text"},{default:l(()=>[i(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])):B("",!0)])],64)}const re=S(z,[["render",se]]);export{re as default};
